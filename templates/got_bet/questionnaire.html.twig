{% extends 'base.html.twig' %}

{% block title %}GotBet - Questionnaire{% endblock %}

{% block body  %}

    {% if (app.user.jouer == 0)%}
    <div class="jumbotrol" >
        <h1 class="display-5" style="font-family: 'viking'" >Questionnaire</h1>
        <p class="lead">Devinez le futur des personnages de Game Of Thrones dans l'ultime saison.</br>
                        Chaque bonne réponse vous rapportera 1 point.</br>
                        Découvrez après le dernier épisode votre nombre de points et vos classement parmi tous les participants !</br>
                      </br>
                        Comment jouer ? </br>
                        Choisissez parmi la liste déroulante : vivant, mort ou marcheur blanc puis validez vos réponses.
        </p>
    </div>
    <div class="container">

        <div class="row justify-content-center">
            <div class="col-6">
            <div style="margin-left:20px;">
                <div class="card border-primary mb-3" style="max-width: 30rem;">
                    <div class="card-header">Personnages</div>
                        <div class="card-body">
                        <form action="{{ path('createReponse') }}" method="POST">
                            <table class="table table">
                                <thead>
                                    <tr>
                                        <th scope="col">Prénom</th>
                                        <th scope="col">Nom</th>
                                        <th scope="col">Etat</th>
                                    </tr>
                                </thead>
                                        <tbody>
                                            <form action="">
                                                {% for perso in personnages %}
                                                    <tr>
                                                    <td>{{ perso.prenom }}</td>
                                                    <td id="{{ perso.id }}" class="id">{{ perso.nom }}</td>
                                                    <td>
                                                        <div class="form-group">
                                                            <select class="custom-select" name="statut_{{ perso.id }}" id="statut_{{ perso.id }}">
                                                                <option>Vivant</option>
                                                                <option>Mort</option>
                                                                <option>Marcheur blanc</option>
                                                            </select>
                                                        </div>
                                                    </td>
                                                    </tr>
                                                {% endfor %}
                                            </form>
                                        </tbody>
                            </table>
                            <button type="submit" class="btn btn-outline-primary btn-block" id="validate">Valider</button>
                            </form>
                        </div>
                    </div>
                </div>
            </div>

    </div>
    {% else %}
    <div class="jumbotrol" >
        <h1 class="display-4" style="font-family: 'viking'">Questionnaire</h1>
        <p class="lead">Vous avez déjà répondu au questionnaire. </br>
                        Rendez vous sur la page "Mon compte" pour consulter vos réponses.
        </p>
    </div>
    {% endif %}
{% endblock %}
{% block script %}

<script>
    $("#validate").click(function(){
        var id= $(".id").attr("id");
        var statut= $("#statut").val();
        $.ajax({
            type:"POST",
            url:"{{path('createReponse')}}",
            data: "id = "+ id +"& statut = "+ statut,
            success: function(data){
                console.log(data);
            }
        })
    });
</script>

{% endblock %}
